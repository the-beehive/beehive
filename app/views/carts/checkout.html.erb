<section class="cart-content">
  <h3>Payment</h3>
  <% @checkout_total = notice %>
  <% session[:cart_total] = @checkout_total %>
  <h4>Your total is <%= number_to_currency(@order.total)%></h4>

  <% @order.order_items.each do |o| %>
    <div class="content-container">
      <div class="item-img">
        <% img = o.product.images.first %>
        <% if img %>
          <%= image_tag img.uploaded_file, width: 150, height: 150 %>
        <% else %>
          <p>Image Not Available</p>
        <% end %>
      </div>
      <div class="hex-fabric">
        <div class="hexagon"></div>
        <p><%= image_tag o.fabric_design_url, width: 100, height: 100, :class => "hexagon-thumb" %></p>
        <% o.product_id %>
        <% o.order_id %>
      </div>
      <div class="item-details">
        <h4><%= o.name %></h4>
        <h4><%= number_to_currency(o.unit_price, unit: "$") %></h4>
        <p>Shipping: <%= number_to_currency(o.shipping, unit: "$") %></p>
        <%= form_for o do |q| %>
          <%= q.number_field :quantity %>
          <%= q.submit 'Update Quantity', method: :update, :class => 'quantity-bttn'%>
        <% end %>
        <p><%= link_to "Remove from cart", o, method: :delete, :class => 'remove-item' %></p>
      </div>
    </div>
  <% end %>



  <%= form_tag charges_path do %>
    <article>
      <% if flash[:error].present? %>
        <div id="error_explanation">
          <p><%= flash[:error] %></p>
        </div>
      <% end %>
      <label class="amount">
        <span></span>
      </label>
    </article>

    <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
            data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
            data-description="Cart Checkout"
            data-amount="<%= number_to_currency(@checkout_total) %>"
            data-locale="auto"></script>
  <% end %>
</section>
